--------------------------------------------------
-- LOAD RAYFIELD
--------------------------------------------------
local Rayfield = loadstring(game:HttpGet(
	"https://raw.githubusercontent.com/SiriusSoftwareLtd/Rayfield/main/source.lua"
))()

--------------------------------------------------
-- WINDOW + KEY SYSTEM (FIXED)
--------------------------------------------------
local Window = Rayfield:CreateWindow({
	Name = "Hacking",
	LoadingTitle = "Hacking",
	LoadingSubtitle = "just for fun ðŸ˜ˆ",
	KeySystem = true,
	KeySettings = {
		Title = "Key System",
		Subtitle = "Enter Key",
		Note = "Key required",
		SaveKey = false,
		Key = "ADMIN-123"
	}
})

--------------------------------------------------
-- SERVICES
--------------------------------------------------
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

--------------------------------------------------
-- TABS
--------------------------------------------------
local PlayerTab = Window:CreateTab("Player", 4483362458)
local VisualTab = Window:CreateTab("Visual", 4483362458)
local AdminTab  = Window:CreateTab("Fake Admin", 4483362458)

--------------------------------------------------
-- CHARACTER
--------------------------------------------------
local character, humanoid, hrp
local function setupCharacter()
	character = player.Character or player.CharacterAdded:Wait()
	humanoid = character:WaitForChild("Humanoid")
	hrp = character:WaitForChild("HumanoidRootPart")
end
setupCharacter()
player.CharacterAdded:Connect(setupCharacter)

--------------------------------------------------
-- INVISIBLE (CLIENTSIDE ONLY â€“ LIMIT)
--------------------------------------------------
local Invisible = false

local function setInvisible(state)
	if not character then return end
	for _,obj in ipairs(character:GetDescendants()) do
		if obj:IsA("BasePart") then
			obj.LocalTransparencyModifier = state and 1 or 0
		elseif obj:IsA("Decal") then
			obj.Transparency = state and 1 or 0
		end
	end
end

PlayerTab:CreateToggle({
	Name = "Invisible (client only)",
	Callback = function(v)
		Invisible = v
		setInvisible(v)
	end
})

--------------------------------------------------
-- NOCLIP
--------------------------------------------------
local noclipConn
PlayerTab:CreateToggle({
	Name = "Noclip",
	Callback = function(v)
		if noclipConn then noclipConn:Disconnect() noclipConn=nil end
		if v then
			noclipConn = RunService.Stepped:Connect(function()
				if character then
					for _,p in ipairs(character:GetDescendants()) do
						if p:IsA("BasePart") then
							p.CanCollide = false
						end
					end
				end
			end)
		end
	end
})

--------------------------------------------------
-- FLY
--------------------------------------------------
local FlyEnabled = false
local FlySpeed = 50
local bv, bg

local function startFly()
	if FlyEnabled then return end
	FlyEnabled = true
	humanoid.PlatformStand = true

	bv = Instance.new("BodyVelocity", hrp)
	bv.MaxForce = Vector3.new(1e9,1e9,1e9)

	bg = Instance.new("BodyGyro", hrp)
	bg.MaxTorque = Vector3.new(1e9,1e9,1e9)
	bg.P = 90000
end

local function stopFly()
	FlyEnabled = false
	humanoid.PlatformStand = false
	if bv then bv:Destroy() end
	if bg then bg:Destroy() end
end

RunService.RenderStepped:Connect(function()
	if not FlyEnabled or not bv then return end
	local dir = Vector3.zero
	if UIS:IsKeyDown(Enum.KeyCode.W) then dir += camera.CFrame.LookVector end
	if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= camera.CFrame.LookVector end
	if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= camera.CFrame.RightVector end
	if UIS:IsKeyDown(Enum.KeyCode.D) then dir += camera.CFrame.RightVector end
	if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += camera.CFrame.UpVector end
	if UIS:IsKeyDown(Enum.KeyCode.LeftShift) then dir -= camera.CFrame.UpVector end
	bv.Velocity = dir.Magnitude > 0 and dir.Unit * FlySpeed or Vector3.zero
	bg.CFrame = camera.CFrame
end)

PlayerTab:CreateToggle({
	Name = "Fly",
	Callback = function(v)
		if v then startFly() else stopFly() end
	end
})

PlayerTab:CreateSlider({
	Name = "Fly Speed",
	Range = {20,300},
	CurrentValue = 50,
	Callback = function(v)
		FlySpeed = v
	end
})

--------------------------------------------------
-- OVERHEAD TEXT + COLOR (FIXED)
--------------------------------------------------
local tag, tagLabel
local tagColor = Color3.fromRGB(255,0,0)

local function createTag()
	if tag then tag:Destroy() end
	local head = character:FindFirstChild("Head")
	if not head then return end

	tag = Instance.new("BillboardGui", head)
	tag.Size = UDim2.new(0,200,0,50)
	tag.StudsOffset = Vector3.new(0,2.5,0)
	tag.AlwaysOnTop = true

	tagLabel = Instance.new("TextLabel", tag)
	tagLabel.Size = UDim2.new(1,0,1,0)
	tagLabel.BackgroundTransparency = 1
	tagLabel.Text = "HACKING"
	tagLabel.TextScaled = true
	tagLabel.Font = Enum.Font.GothamBlack
	tagLabel.TextStrokeTransparency = 0
	tagLabel.TextColor3 = tagColor
end

VisualTab:CreateToggle({
	Name = "Overhead Text",
	Callback = function(v)
		if v then createTag()
		elseif tag then tag:Destroy() tag=nil end
	end
})

VisualTab:CreateColorPicker({
	Name = "Text Color",
	Default = tagColor,
	Callback = function(c)
		tagColor = c
		if tagLabel then
			tagLabel.TextColor3 = c
		end
	end
})

--------------------------------------------------
-- FAKE ADMIN MESSAGES
--------------------------------------------------
local function sysMsg(msg)
	StarterGui:SetCore("ChatMakeSystemMessage", {
		Text = msg,
		Color = Color3.fromRGB(255,60,60),
		Font = Enum.Font.SourceSansBold,
		TextSize = 18
	})
end

AdminTab:CreateInput({
	Name = "Fake /ban",
	Callback = function(name)
		sysMsg("[HD Admin]: "..name.." has been banned.")
	end
})

--------------------------------------------------
Rayfield:Notify({
	Title = "Loaded",
	Content = "Key + ColorPicker fixed",
	Duration = 4
})
