--------------------------------------------------
-- SERVICES
--------------------------------------------------
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

--------------------------------------------------
-- LOAD RAYFIELD
--------------------------------------------------
local Rayfield = loadstring(game:HttpGet(
    "https://raw.githubusercontent.com/SiriusSoftwareLtd/Rayfield/main/source.lua"
))()

--------------------------------------------------
-- WINDOW + KEY
--------------------------------------------------
local Window = Rayfield:CreateWindow({
    Name = "Hacking",
    LoadingTitle = "Hacking",
    LoadingSubtitle = "stable build",
    KeySystem = true,
    KeySettings = {
        Title = "Key System",
        Subtitle = "Enter Key",
        Note = "Key = ADMIN-123",
        SaveKey = false,
        Key = "ADMIN-123"
    }
})

--------------------------------------------------
-- TAB
--------------------------------------------------
local PlayerTab = Window:CreateTab("Player", 4483362458)

--------------------------------------------------
-- CHARACTER
--------------------------------------------------
local character, humanoid, hrp
local function setupCharacter()
    character = player.Character or player.CharacterAdded:Wait()
    humanoid = character:WaitForChild("Humanoid")
    hrp = character:WaitForChild("HumanoidRootPart")
end
setupCharacter()
player.CharacterAdded:Connect(setupCharacter)

--------------------------------------------------
-- FLY
--------------------------------------------------
local FlyEnabled = false
local FlySpeed = 50
local bv, bg

local function startFly()
    if FlyEnabled then return end
    FlyEnabled = true
    humanoid.PlatformStand = true

    bv = Instance.new("BodyVelocity", hrp)
    bv.MaxForce = Vector3.new(1e9,1e9,1e9)
    bv.Velocity = Vector3.zero

    bg = Instance.new("BodyGyro", hrp)
    bg.MaxTorque = Vector3.new(1e9,1e9,1e9)
    bg.P = 90000
    bg.CFrame = hrp.CFrame
end

local function stopFly()
    FlyEnabled = false
    humanoid.PlatformStand = false
    if bv then bv:Destroy() bv=nil end
    if bg then bg:Destroy() bg=nil end
end

RunService.RenderStepped:Connect(function()
    if not FlyEnabled or not bv or not bg then return end
    local dir = Vector3.zero
    if UIS:IsKeyDown(Enum.KeyCode.W) then dir += camera.CFrame.LookVector end
    if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= camera.CFrame.LookVector end
    if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= camera.CFrame.RightVector end
    if UIS:IsKeyDown(Enum.KeyCode.D) then dir += camera.CFrame.RightVector end
    if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += camera.CFrame.UpVector end
    if UIS:IsKeyDown(Enum.KeyCode.LeftShift) then dir -= camera.CFrame.UpVector end
    bv.Velocity = dir.Magnitude > 0 and dir.Unit * FlySpeed or Vector3.zero
    bg.CFrame = camera.CFrame
end)

PlayerTab:CreateToggle({
    Name = "Fly",
    Callback = function(v)
        if v then startFly() else stopFly() end
    end
})

-- Fly Speed Slider + Input
PlayerTab:CreateSlider({
    Name = "Fly Speed",
    Range = {20,300},
    CurrentValue = FlySpeed,
    Callback = function(v)
        FlySpeed = v
    end
})

PlayerTab:CreateInput({
    Name = "Fly Speed (number)",
    PlaceholderText = "Enter speed",
    Callback = function(v)
        local num = tonumber(v)
        if num then FlySpeed = num end
    end
})

--------------------------------------------------
-- JUMP BOOST (Toggle + Slider + Input)
--------------------------------------------------
local jumpBoost = false
local jumpPower = 100

PlayerTab:CreateToggle({
    Name = "Jump Boost",
    Callback = function(v)
        jumpBoost = v
        humanoid.JumpPower = v and jumpPower or 50
    end
})

PlayerTab:CreateSlider({
    Name = "Jump Power",
    Range = {50,300},
    CurrentValue = jumpPower,
    Callback = function(v)
        jumpPower = v
        if jumpBoost then humanoid.JumpPower = v end
    end
})

PlayerTab:CreateInput({
    Name = "Jump Power (number)",
    PlaceholderText = "Enter jump power",
    Callback = function(v)
        local num = tonumber(v)
        if num then
            jumpPower = num
            if jumpBoost then humanoid.JumpPower = num end
        end
    end
})

--------------------------------------------------
-- NOCLIP
--------------------------------------------------
local noclip = false
PlayerTab:CreateToggle({
    Name = "Noclip",
    Callback = function(v)
        noclip = v
    end
})

RunService.Stepped:Connect(function()
    if character then
        for _,p in pairs(character:GetDescendants()) do
            if p:IsA("BasePart") then
                p.CanCollide = not noclip
            end
        end
    end
end)

--------------------------------------------------
-- INVISIBLE
--------------------------------------------------
PlayerTab:CreateToggle({
    Name = "Invisible",
    Callback = function(v)
        if not character then return end
        for _,p in pairs(character:GetDescendants()) do
            if p:IsA("BasePart") then
                p.Transparency = v and 1 or 0
                p.LocalTransparencyModifier = 0
            elseif p:IsA("Decal") then
                p.Transparency = v and 1 or 0
            end
        end
    end
})

--------------------------------------------------
-- TP TO PLAYER (Dropdown + Button)
--------------------------------------------------
local selectedTP = nil

local function updatePlayerList()
    local list = {}
    for _,p in pairs(Players:GetPlayers()) do
        if p ~= player then table.insert(list,p.Name) end
    end
    return list
end

local tpDropdown = PlayerTab:CreateDropdown({
    Name = "Select Player",
    Options = updatePlayerList(),
    Callback = function(v)
        selectedTP = v
    end
})

-- Refresh dropdown auf Player Join/Leave
Players.PlayerAdded:Connect(function()
    tpDropdown:Refresh(updatePlayerList())
end)
Players.PlayerRemoving:Connect(function()
    tpDropdown:Refresh(updatePlayerList())
end)

PlayerTab:CreateButton({
    Name = "Teleport",
    Callback = function()
        if selectedTP then
            local target = Players:FindFirstChild(selectedTP)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                hrp.CFrame = target.Character.HumanoidRootPart.CFrame + Vector3.new(0,3,0)
            end
        end
    end
})

--------------------------------------------------
Rayfield:Notify({
    Title = "Loaded",
    Content = "Fly + Jump + TP ready with numbers",
    Duration = 4
})

