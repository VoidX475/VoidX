--------------------------------------------------
-- SAFE KEY SYSTEM
--------------------------------------------------
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")
local camera = workspace.CurrentCamera

local REQUIRED_KEY = "ADMIN-123"
local OWNER_USERID = player.UserId

-- Kein Kick mehr, nur Script Stop
if player.UserId ~= OWNER_USERID then
	if getgenv().KEY ~= REQUIRED_KEY then
		warn("Invalid Key â€“ script stopped.")
		return
	end
end

--------------------------------------------------
-- LOAD RAYFIELD
--------------------------------------------------
local Rayfield = loadstring(game:HttpGet(
	"https://raw.githubusercontent.com/SiriusSoftwareLtd/Rayfield/main/source.lua"
))()

--------------------------------------------------
-- GUI WINDOW
--------------------------------------------------
local Window = Rayfield:CreateWindow({
	Name = "Hacking",
	LoadingTitle = "Hacking",
	LoadingSubtitle = "just for fun ðŸ˜ˆ",
	KeySystem = false
})

local PlayerTab = Window:CreateTab("Player", 4483362458)
local AdminTab  = Window:CreateTab("Fake Admin", 4483362458)
local VisualTab = Window:CreateTab("Visual", 4483362458)

--------------------------------------------------
-- CHARACTER SETUP
--------------------------------------------------
local character, humanoid, hrp

local function setupCharacter()
	character = player.Character or player.CharacterAdded:Wait()
	humanoid = character:WaitForChild("Humanoid")
	hrp = character:WaitForChild("HumanoidRootPart")
end

setupCharacter()
player.CharacterAdded:Connect(setupCharacter)

--------------------------------------------------
-- GODMODE
--------------------------------------------------
local GodMode = false

PlayerTab:CreateToggle({
	Name = "GodMode",
	Callback = function(v)
		GodMode = v
		if humanoid then
			humanoid.BreakJointsOnDeath = not v
		end
	end
})

RunService.Heartbeat:Connect(function()
	if GodMode and humanoid then
		humanoid.Health = humanoid.MaxHealth
	end
end)

--------------------------------------------------
-- JUMP BOOST
--------------------------------------------------
PlayerTab:CreateSlider({
	Name = "Jump Boost",
	Range = {50,600},
	CurrentValue = 50,
	Callback = function(v)
		if humanoid then
			humanoid.UseJumpPower = true
			humanoid.JumpPower = v
		end
	end
})

--------------------------------------------------
-- INVISIBLE (BLOCK FIX)
--------------------------------------------------
local Invisible = false

local function setInvisible(state)
	if not character then return end

	for _,obj in ipairs(character:GetDescendants()) do
		if obj:IsA("BasePart") then
			obj.LocalTransparencyModifier = state and 1 or 0
			if obj.Name == "HumanoidRootPart" then
				obj.LocalTransparencyModifier = 1
			end
		elseif obj:IsA("Decal") then
			obj.Transparency = state and 1 or 0
		end
	end
end

PlayerTab:CreateToggle({
	Name = "Invisible",
	CurrentValue = false,
	Callback = function(v)
		Invisible = v
		setInvisible(v)
	end
})

player.CharacterAdded:Connect(function()
	if Invisible then
		task.wait(0.5)
		setInvisible(true)
	end
end)

--------------------------------------------------
-- FLY
--------------------------------------------------
local FlyEnabled = false
local FlySpeed = 50
local bv, bg

local function startFly()
	if FlyEnabled or not hrp then return end
	FlyEnabled = true
	humanoid.PlatformStand = true

	bv = Instance.new("BodyVelocity", hrp)
	bv.MaxForce = Vector3.new(1e9,1e9,1e9)

	bg = Instance.new("BodyGyro", hrp)
	bg.MaxTorque = Vector3.new(1e9,1e9,1e9)
	bg.P = 90000
end

local function stopFly()
	FlyEnabled = false
	humanoid.PlatformStand = false
	if bv then bv:Destroy() bv=nil end
	if bg then bg:Destroy() bg=nil end
end

RunService.RenderStepped:Connect(function()
	if not FlyEnabled or not bv then return end
	local dir = Vector3.zero

	if UIS:IsKeyDown(Enum.KeyCode.W) then dir += camera.CFrame.LookVector end
	if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= camera.CFrame.LookVector end
	if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= camera.CFrame.RightVector end
	if UIS:IsKeyDown(Enum.KeyCode.D) then dir += camera.CFrame.RightVector end
	if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += camera.CFrame.UpVector end
	if UIS:IsKeyDown(Enum.KeyCode.LeftShift) then dir -= camera.CFrame.UpVector end

	bv.Velocity = dir.Magnitude > 0 and dir.Unit * FlySpeed or Vector3.zero
	bg.CFrame = camera.CFrame
end)

PlayerTab:CreateToggle({
	Name = "Fly",
	Callback = function(v)
		if v then startFly() else stopFly() end
	end
})

PlayerTab:CreateSlider({
	Name = "Fly Speed",
	Range = {20,300},
	CurrentValue = 50,
	Callback = function(v)
		FlySpeed = v
	end
})

--------------------------------------------------
-- NOCLIP (FIXED)
--------------------------------------------------
local NoclipEnabled = false
local noclipConn

local function setNoclip(state)
	NoclipEnabled = state

	if noclipConn then
		noclipConn:Disconnect()
		noclipConn = nil
	end

	if state then
		noclipConn = RunService.Stepped:Connect(function()
			if character then
				for _,part in ipairs(character:GetDescendants()) do
					if part:IsA("BasePart") then
						part.CanCollide = false
					end
				end
			end
		end)
	else
		if character then
			for _,part in ipairs(character:GetDescendants()) do
				if part:IsA("BasePart") then
					part.CanCollide = true
				end
			end
		end
	end
end

PlayerTab:CreateToggle({
	Name = "Noclip",
	CurrentValue = false,
	Callback = function(v)
		setNoclip(v)
	end
})

player.CharacterAdded:Connect(function()
	if NoclipEnabled then
		task.wait(0.5)
		setNoclip(true)
	end
end)

--------------------------------------------------
-- TP TO PLAYER
--------------------------------------------------
PlayerTab:CreateInput({
	Name = "TP to Player",
	PlaceholderText = "name",
	Callback = function(text)
		text = text:lower()
		for _,plr in ipairs(Players:GetPlayers()) do
			if plr.Name:lower():sub(1,#text) == text then
				if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
					hrp.CFrame = plr.Character.HumanoidRootPart.CFrame + Vector3.new(0,3,0)
				end
				break
			end
		end
	end
})

--------------------------------------------------
-- FAKE ADMIN COMMANDS
--------------------------------------------------
local function systemMessage(msg)
	StarterGui:SetCore("ChatMakeSystemMessage", {
		Text = msg,
		Color = Color3.fromRGB(255,60,60),
		Font = Enum.Font.SourceSansBold,
		TextSize = 18
	})
end

AdminTab:CreateInput({
	Name = "Fake /ban",
	PlaceholderText = "player",
	Callback = function(name)
		systemMessage("[HD Admin]: "..name.." has been permanently banned.")
	end
})

AdminTab:CreateInput({
	Name = "Fake /kick",
	PlaceholderText = "player",
	Callback = function(name)
		systemMessage("[HD Admin]: "..name.." has been kicked from the server.")
	end
})

AdminTab:CreateInput({
	Name = "Fake /warn",
	PlaceholderText = "player",
	Callback = function(name)
		systemMessage("[HD Admin]: Warning issued to "..name..".")
	end
})

--------------------------------------------------
-- OVERHEAD TEXT + COLOR
--------------------------------------------------
local tagColor = Color3.fromRGB(255,0,0)
local tag

local function createTag()
	if tag then tag:Destroy() end
	local head = character:FindFirstChild("Head")
	if not head then return end

	tag = Instance.new("BillboardGui", head)
	tag.Size = UDim2.new(0,200,0,50)
	tag.StudsOffset = Vector3.new(0,2.5,0)
	tag.AlwaysOnTop = true

	local lbl = Instance.new("TextLabel", tag)
	lbl.Size = UDim2.new(1,0,1,0)
	lbl.BackgroundTransparency = 1
	lbl.Text = "HACKING"
	lbl.Font = Enum.Font.GothamBlack
	lbl.TextScaled = true
	lbl.TextStrokeTransparency = 0
	lbl.TextColor3 = tagColor
end

VisualTab:CreateToggle({
	Name = "Overhead Text",
	Callback = function(v)
		if v then createTag()
		elseif tag then tag:Destroy() tag=nil end
	end
})

VisualTab:CreateColorPicker({
	Name = "Text Color",
	Default = tagColor,
	Callback = function(c)
		tagColor = c
		if tag then
			tag.TextLabel.TextColor3 = c
		end
	end
})

--------------------------------------------------
Rayfield:Notify({
	Title = "Loaded",
	Content = "All systems active ðŸ˜ˆ",
	Duration = 5
})

